# ==============================================================================
# Ref: "Alpha 101"
# Alpha#12:

# sign[ delta(volume,1) ] * {-1 * [ delta(close,1) ]}
#       |------ 1 ----|             |------ 1 ----|
# |--------- 2 ---------|    |---------- 2 ---------|

# 算法
# 1.分别计算 Volume 和 close 的价差
# 2.
#
# 含义
# 如果出现成交量上升，但是收盘价却下跌，则发出买入信号
# 
# 关联：
# 
# ==============================================================================


# ------------------------------------------------------------------------------
## Alpha Name
alphaName <- 'alpha101_12'

## 需要去除的日期
truncatedTD <- 1
# ------------------------------------------------------------------------------


# ==========: 提取dtX ===============================================================================
# ------------------------------------------------------------------------------
# dtX
# ------------------------------------------------------------------------------ 

# ------------------------------------------------------------------------------


# ------------------------------------------------------------------------------
dtX <- inSample[, .SD[.N > truncatedTD]
                , by = 'InstrumentID'] %>%
        .[,":="(
                signal1 = sign(volume - shift(volume,1L,type='lag')),
                signal2 = close - shift(close,1L,type='lag')
            )
          ,by='InstrumentID'] %>%
        .[!is.na(signal1) & !is.na(signal2)] %>%
        .[,mySignal := signal1 * signal2]
# ==================================================================================================
